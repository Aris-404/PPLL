<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glam Up</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        /* CSS tetap sama seperti sebelumnya */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #e75480;
            --primary-light: #f8b6c9;
            --primary-dark: #d6336c;
            --secondary: #ff9a8b;
            --accent: #ff6b6b;
            --text: #4a4a4a;
            --text-light: #8a8a8a;
            --background: #fef6f9;
            --card-bg: #ffffff;
            --border: #f0e6ea;
            --shadow: 0 8px 30px rgba(231, 84, 128, 0.08);
            --gradient: linear-gradient(135deg, #e75480 0%, #ff9a8b 100%);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--background);
            min-height: 100vh;
            padding: 20px;
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .header {
            background: var(--gradient);
            color: white;
            padding: 40px 50px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            pointer-events: none;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.2rem;
            margin-bottom: 12px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            font-weight: 300;
        }

        .search-container {
            margin-top: 30px;
            position: relative;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .search-container input {
            width: 100%;
            padding: 18px 25px;
            border-radius: 50px;
            border: none;
            font-size: 16px;
            box-shadow: 0 10px 30px rgba(231, 84, 128, 0.15);
            background: rgba(255, 255, 255, 0.95);
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .search-container input:focus {
            outline: none;
            box-shadow: 0 15px 40px rgba(231, 84, 128, 0.25);
            transform: translateY(-2px);
        }

        .search-container button {
            position: absolute;
            right: 6px;
            top: 6px;
            background: var(--gradient);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            box-shadow: 0 5px 15px rgba(231, 84, 128, 0.3);
        }

        .search-container button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(231, 84, 128, 0.4);
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 2.5fr;
            gap: 40px;
            padding: 40px;
        }

        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 1fr;
                gap: 30px;
            }
        }

        .preference-section {
            background: var(--card-bg);
            padding: 35px 30px;
            border-radius: 20px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            height: fit-content;
            position: sticky;
            top: 30px;
        }

        .preference-section h2 {
            color: var(--primary);
            margin-bottom: 25px;
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            font-family: 'Playfair Display', serif;
        }

        .preference-section h2 i {
            margin-right: 12px;
            font-size: 1.3rem;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--text);
            font-size: 0.95rem;
        }

        .form-group select, .form-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1.5px solid var(--border);
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s ease;
            background-color: var(--card-bg);
            font-family: 'Poppins', sans-serif;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e75480' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 20px center;
            background-size: 16px;
        }

        .form-group select:focus, .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(231, 84, 128, 0.1);
        }

        .btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(231, 84, 128, 0.25);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(231, 84, 128, 0.35);
        }

        .btn i {
            margin-right: 10px;
        }

        .recommendations-section {
            background: var(--card-bg);
        }

        .section-title {
            color: var(--primary);
            margin-bottom: 25px;
            font-size: 1.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            font-family: 'Playfair Display', serif;
        }

        .section-title i {
            margin-right: 12px;
            font-size: 1.5rem;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .product-card {
            background: var(--card-bg);
            border-radius: 18px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.4s ease;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(231, 84, 128, 0.15);
        }

        .product-card:hover::before {
            transform: scaleX(1);
        }

        .product-name {
            font-weight: 600;
            color: var(--text);
            margin-bottom: 8px;
            font-size: 1.2rem;
            line-height: 1.4;
        }

        .product-brand {
            color: var(--primary);
            font-size: 0.9rem;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .product-category {
            background: var(--primary-light);
            color: var(--primary-dark);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: inline-block;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .product-rating {
            color: #ffc107;
            font-weight: bold;
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .product-price {
            margin-top: 10px;
            font-weight: 600;
            color: var(--accent);
            font-size: 1.1rem;
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .recommendation-card {
            background: linear-gradient(135deg, #fef6f9 0%, #fceef3 100%);
            border-radius: 18px;
            padding: 25px;
            border-left: 4px solid var(--primary);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .recommendation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 0;
        }

        .recommendation-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(231, 84, 128, 0.15);
        }

        .recommendation-card:hover::before {
            opacity: 0.03;
        }

        .recommendation-card > * {
            position: relative;
            z-index: 1;
        }

        .similarity-badge {
            background: var(--accent);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            float: right;
            font-weight: 500;
        }

        .loading {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .loading i {
            margin-right: 10px;
        }

        .error {
            background: #ffe6e6;
            color: var(--primary-dark);
            padding: 20px;
            border-radius: 12px;
            margin: 10px 0;
            border-left: 4px solid var(--accent);
        }

        .history-section {
            margin-top: 35px;
            padding: 25px;
            background: linear-gradient(135deg, #fef6f9 0%, #fceef3 100%);
            border-radius: 16px;
            border: 1px solid var(--border);
        }

        .history-items {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding: 15px 0;
        }

        .history-items::-webkit-scrollbar {
            height: 6px;
        }

        .history-items::-webkit-scrollbar-thumb {
            background: var(--primary-light);
            border-radius: 10px;
        }

        .history-item {
            background: white;
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            cursor: pointer;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            white-space: nowrap;
            color: var(--text);
            box-shadow: 0 3px 10px rgba(231, 84, 128, 0.08);
        }

        .history-item:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 84, 128, 0.2);
        }

        .filter-options {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            background: white;
            border: 1.5px solid var(--border);
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: var(--text);
            font-weight: 500;
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(231, 84, 128, 0.25);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 40px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
            transition: color 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            color: var(--primary);
            background: var(--background);
        }

        .product-detail {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .product-detail {
                grid-template-columns: 1fr;
            }
        }

        .product-image {
            background: linear-gradient(135deg, #fef6f9 0%, #fceef3 100%);
            border-radius: 18px;
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: var(--primary);
        }

        .product-info h3 {
            margin-bottom: 15px;
            color: var(--text);
            font-size: 1.8rem;
            font-family: 'Playfair Display', serif;
        }

        .product-info p {
            margin-bottom: 12px;
            color: var(--text-light);
        }

        .product-info p strong {
            color: var(--text);
            min-width: 120px;
            display: inline-block;
        }

        .star-rating {
            display: flex;
            margin: 15px 0;
            align-items: center;
        }

        .star {
            color: #ffd700;
            margin-right: 4px;
            font-size: 1.2rem;
        }

        .price-tag {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent);
            margin: 20px 0;
            font-family: 'Playfair Display', serif;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .action-btn {
            padding: 15px 25px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            flex: 1;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .primary-btn {
            background: var(--gradient);
            color: white;
            box-shadow: 0 5px 15px rgba(231, 84, 128, 0.3);
        }

        .secondary-btn {
            background: white;
            color: var(--text);
            border: 1.5px solid var(--border);
        }

        .action-btn:hover {
            transform: translateY(-3px);
        }

        .no-results {
            text-align: center;
            padding: 50px 20px;
            color: var(--text-light);
            font-style: italic;
            font-size: 1.1rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .clear-history {
            background: transparent;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 0.9rem;
            text-decoration: underline;
            font-weight: 500;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-new {
            background: var(--accent);
            color: white;
        }

        .badge-popular {
            background: var(--primary);
            color: white;
        }

        .recommendation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .recommendation-title {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 25px;
            font-family: 'Playfair Display', serif;
        }

        .view-all-btn {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .view-all-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .recommendation-section {
            margin-bottom: 50px;
        }

        @media (max-width: 768px) {
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .content {
                padding: 25px 20px;
            }
            
            .preference-section {
                padding: 25px 20px;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-palette"></i> BeautyFinder</h1>
            <p>Sistem Rekomendasi Kosmetik Personal</p>
            
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Cari produk kosmetik...">
                <button onclick="searchProducts()"><i class="fas fa-search"></i> Cari</button>
            </div>
        </div>

        <div class="content">
            <div class="preference-section">
                <h2><i class="fas fa-sliders-h"></i> Preferensi Saya</h2>
                
                <div class="form-group">
                    <label for="skinType"><i class="fas fa-user-circle"></i> Jenis Kulit</label>
                    <select id="skinType">
                        <option value="all">Semua Jenis Kulit</option>
                        <option value="oily">Berminyak</option>
                        <option value="dry">Kering</option>
                        <option value="combination">Kombinasi</option>
                        <option value="sensitive">Sensitif</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="category"><i class="fas fa-tags"></i> Kategori Produk</label>
                    <select id="category">
                        <option value="">Semua Kategori</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="brand"><i class="fas fa-copyright"></i> Brand</label>
                    <select id="brand">
                        <option value="">Semua Brand</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="priceRange"><i class="fas fa-money-bill-wave"></i> Rentang Harga</label>
                    <select id="priceRange">
                        <option value="">Semua Harga</option>
                        <option value="low">Ekonomis (Rp 50rb - 150rb)</option>
                        <option value="medium">Menengah (Rp 150rb - 500rb)</option>
                        <option value="high">Premium (Rp 500rb+)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-star"></i> Rating Minimal</label>
                    <div class="filter-options" id="ratingFilter">
                        <button class="filter-btn" data-rating="0">Semua</button>
                        <button class="filter-btn" data-rating="3">3+</button>
                        <button class="filter-btn active" data-rating="4">4+</button>
                        <button class="filter-btn" data-rating="4.5">4.5+</button>
                    </div>
                </div>

                <button class="btn" onclick="getPreferenceRecommendations()">
                    <i class="fas fa-bullseye"></i> Dapatkan Rekomendasi
                </button>

                <div class="history-section">
                    <div class="section-header">
                        <h3><i class="fas fa-history"></i> Riwayat Dilihat</h3>
                        <button class="clear-history" onclick="clearHistory()">Hapus</button>
                    </div>
                    <div id="historyItems" class="history-items">
                        <div style="color: var(--text-light); font-style: italic;">Belum ada riwayat</div>
                    </div>
                </div>
            </div>

            <div class="recommendations-section">
                <!-- Rekomendasi Personal Langsung -->
                <div class="recommendation-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-magic"></i> Rekomendasi Personal</h2>
                        <button class="view-all-btn" onclick="showAllRecommendations()">
                            <i class="fas fa-expand"></i> Lihat Semua
                        </button>
                    </div>
                    <div id="personalRecommendationsGrid" class="recommendations-grid">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> Menghasilkan rekomendasi personal...</div>
                    </div>
                </div>

                <!-- Produk Populer -->
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-fire"></i> Produk Populer</h2>
                    <div class="filter-options">
                        <button class="filter-btn active" onclick="filterProducts('all')">Semua</button>
                        <button class="filter-btn" onclick="filterProducts('foundation')">Foundation</button>
                        <button class="filter-btn" onclick="filterProducts('lipstick')">Lipstick</button>
                        <button class="filter-btn" onclick="filterProducts('skincare')">Skincare</button>
                    </div>
                </div>
                <div id="productsGrid" class="products-grid">
                    <div class="loading"><i class="fas fa-spinner fa-spin"></i> Memuat produk...</div>
                </div>

                <!-- Rekomendasi Berdasarkan Produk -->
                <h2 class="section-title"><i class="fas fa-heart"></i> Rekomendasi Untuk Anda</h2>
                <div id="recommendationsGrid" class="recommendations-grid">
                    <div class="loading">Pilih produk untuk melihat rekomendasi serupa</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detail Produk -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- Modal Semua Rekomendasi -->
    <div class="modal" id="allRecommendationsModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAllRecommendationsModal()">&times;</span>
            <div id="allRecommendationsContent">
                <h2 style="color: var(--primary); margin-bottom: 30px; font-family: 'Playfair Display', serif;">
                    <i class="fas fa-star"></i> Semua Rekomendasi Untuk Anda
                </h2>
                <div id="allRecommendationsGrid" class="recommendations-grid">
                    <!-- Semua rekomendasi akan ditampilkan di sini -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data produk lengkap
        const productsData = [
            // Foundation
            {
                product_id: 1,
                name: "Matte Foundation Pro",
                brand: "Lux Beauty",
                category: "foundation",
                skin_type: "oily",
                price_range: "medium",
                rating: 4.5,
                is_new: true,
                description: "Foundation matte dengan coverage tinggi untuk kulit berminyak, tahan hingga 12 jam"
            },
            {
                product_id: 2,
                name: "Hydra Glow Foundation",
                brand: "Skin Essence",
                category: "foundation",
                skin_type: "dry",
                price_range: "high",
                rating: 4.8,
                is_new: false,
                description: "Foundation dewy dengan kandungan hyaluronic acid untuk kulit kering"
            },
            {
                product_id: 3,
                name: "CC Cream Light",
                brand: "Natural Glow",
                category: "foundation",
                skin_type: "sensitive",
                price_range: "medium",
                rating: 4.4,
                is_new: true,
                description: "CC cream ringan dengan SPF 30 untuk kulit sensitif"
            },
            {
                product_id: 4,
                name: "Perfect Coverage Foundation",
                brand: "Cover Queen",
                category: "foundation",
                skin_type: "combination",
                price_range: "high",
                rating: 4.7,
                is_new: false,
                description: "Foundation full coverage untuk kulit kombinasi"
            },

            // Lipstick
            {
                product_id: 5,
                name: "Velvet Matte Lipstick",
                brand: "Glamour Cosmetics",
                category: "lipstick",
                skin_type: "all",
                price_range: "low",
                rating: 4.2,
                is_new: false,
                description: "Lipstick matte dengan tekstur velvet, tidak membuat bibir kering"
            },
            {
                product_id: 6,
                name: "Liquid Lipstick Supreme",
                brand: "Lip Royal",
                category: "lipstick",
                skin_type: "all",
                price_range: "medium",
                rating: 4.6,
                is_new: true,
                description: "Liquid lipstick tahan lama dengan finish matte sempurna"
            },
            {
                product_id: 7,
                name: "Sheer Gloss Lipstick",
                brand: "Glossy Beauty",
                category: "lipstick",
                skin_type: "all",
                price_range: "low",
                rating: 4.3,
                is_new: false,
                description: "Lipstick glossy dengan warna sheer natural"
            },
            {
                product_id: 8,
                name: "Lip Stain Tint",
                brand: "Tint Master",
                category: "lipstick",
                skin_type: "all",
                price_range: "medium",
                rating: 4.5,
                is_new: true,
                description: "Lip tint dengan warna natural dan tahan lama"
            },

            // Skincare
            {
                product_id: 9,
                name: "Hydrating Serum",
                brand: "Skin Essence",
                category: "skincare",
                skin_type: "dry",
                price_range: "high",
                rating: 4.8,
                is_new: true,
                description: "Serum hydrating dengan hyaluronic acid dan vitamin B5"
            },
            {
                product_id: 10,
                name: "Oil Control Toner",
                brand: "Pure Skin",
                category: "skincare",
                skin_type: "oily",
                price_range: "medium",
                rating: 4.4,
                is_new: false,
                description: "Toner untuk mengontrol minyak dan mengecilkan pori-pori"
            },
            {
                product_id: 11,
                name: "Calming Cream",
                brand: "Sensitive Care",
                category: "skincare",
                skin_type: "sensitive",
                price_range: "high",
                rating: 4.7,
                is_new: true,
                description: "Krim menenangkan untuk kulit sensitif dengan centella asiatica"
            },
            {
                product_id: 12,
                name: "AHA BHA Exfoliator",
                brand: "Renew Skin",
                category: "skincare",
                skin_type: "combination",
                price_range: "high",
                rating: 4.6,
                is_new: false,
                description: "Eksfoliator chemical dengan AHA dan BHA untuk kulit kombinasi"
            },

            // Mascara
            {
                product_id: 13,
                name: "Volume Boost Mascara",
                brand: "Lash Queen",
                category: "mascara",
                skin_type: "sensitive",
                price_range: "medium",
                rating: 4.3,
                is_new: false,
                description: "Mascara untuk volume bulu mata maksimal"
            },
            {
                product_id: 14,
                name: "Lengthening Mascara",
                brand: "Long Lash",
                category: "mascara",
                skin_type: "all",
                price_range: "low",
                rating: 4.5,
                is_new: true,
                description: "Mascara untuk bulu mata tampak lebih panjang"
            },

            // Blush
            {
                product_id: 15,
                name: "Blush Rosy Glow",
                brand: "Cheeky Beauty",
                category: "blush",
                skin_type: "combination",
                price_range: "low",
                rating: 4.6,
                is_new: false,
                description: "Blush dengan warna pink natural dan finish dewy"
            },
            {
                product_id: 16,
                name: "Cream Blush Stick",
                brand: "Creamy Cheeks",
                category: "blush",
                skin_type: "dry",
                price_range: "medium",
                rating: 4.4,
                is_new: true,
                description: "Blush stick creamy dengan aplikasi mudah"
            },

            // Eyeshadow
            {
                product_id: 17,
                name: "Nude Palette",
                brand: "Eye Artistry",
                category: "eyeshadow",
                skin_type: "all",
                price_range: "medium",
                rating: 4.7,
                is_new: true,
                description: "Palette eyeshadow dengan warna-warna nude yang versatile"
            },
            {
                product_id: 18,
                name: "Liquid Eyeshadow",
                brand: "Liquid Glam",
                category: "eyeshadow",
                skin_type: "all",
                price_range: "low",
                rating: 4.3,
                is_new: false,
                description: "Eyeshadow liquid dengan shimmer intens"
            },

            // Concealer
            {
                product_id: 19,
                name: "High Coverage Concealer",
                brand: "Perfect Cover",
                category: "concealer",
                skin_type: "all",
                price_range: "medium",
                rating: 4.7,
                is_new: false,
                description: "Concealer full coverage untuk menutupi noda dan dark circle"
            },

            // Setting Spray
            {
                product_id: 20,
                name: "Matte Setting Spray",
                brand: "Lux Beauty",
                category: "setting spray",
                skin_type: "oily",
                price_range: "medium",
                rating: 4.5,
                is_new: true,
                description: "Setting spray matte untuk make up tahan lama"
            }
        ];

        let allProducts = productsData;
        let viewHistory = JSON.parse(localStorage.getItem('beautyFinderHistory')) || [];

        document.addEventListener('DOMContentLoaded', function() {
            loadInitialData();
            displayProducts(allProducts);
            loadHistory();
            setupEventListeners();
            
            // Generate rekomendasi personal saat halaman dimuat
            generatePersonalRecommendations();
        });

        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchProducts();
                }
            });

            document.querySelectorAll('#ratingFilter .filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#ratingFilter .filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    filterByRating(parseFloat(this.getAttribute('data-rating')));
                });
            });
        }

        function loadInitialData() {
            // Isi dropdown kategori
            const categories = [...new Set(allProducts.map(product => product.category))];
            const categorySelect = document.getElementById('category');
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                categorySelect.appendChild(option);
            });

            // Isi dropdown brand
            const brands = [...new Set(allProducts.map(product => product.brand))];
            const brandSelect = document.getElementById('brand');
            brands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandSelect.appendChild(option);
            });
        }

        function displayProducts(products) {
            const grid = document.getElementById('productsGrid');
            
            if (products.length === 0) {
                grid.innerHTML = '<div class="no-results">Tidak ada produk yang sesuai dengan filter.</div>';
                return;
            }
            
            grid.innerHTML = '';

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => {
                    getProductRecommendations(product.product_id);
                    addToHistory(product);
                    showProductDetail(product);
                };

                const stars = renderStars(product.rating);
                
                let badge = '';
                if (product.is_new) {
                    badge = '<span class="badge badge-new">BARU</span>';
                } else if (product.rating >= 4.5) {
                    badge = '<span class="badge badge-popular">POPULER</span>';
                }

                productCard.innerHTML = `
                    <div class="product-name">${product.name} ${badge}</div>
                    <div class="product-brand">${product.brand}</div>
                    <div class="product-category">${product.category}</div>
                    <div class="product-rating">
                        ${stars}
                        <span style="margin-left: 5px; color: var(--text-light);">${product.rating}</span>
                    </div>
                    <div class="product-price">${formatPrice(product.price_range)}</div>
                    <div style="margin-top: 10px; font-size: 0.9em; color: var(--text-light);">
                        <div><i class="fas fa-user-circle"></i> ${product.skin_type}</div>
                    </div>
                `;

                grid.appendChild(productCard);
            });
        }

        function renderStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            
            for (let i = 1; i <= 5; i++) {
                if (i <= fullStars) {
                    stars += '<i class="fas fa-star star"></i>';
                } else if (i === fullStars + 1 && hasHalfStar) {
                    stars += '<i class="fas fa-star-half-alt star"></i>';
                } else {
                    stars += '<i class="far fa-star star"></i>';
                }
            }
            
            return stars;
        }

        function formatPrice(priceRange) {
            switch(priceRange) {
                case 'low': return 'Rp 50rb - 150rb';
                case 'medium': return 'Rp 150rb - 500rb';
                case 'high': return 'Rp 500rb+';
                default: return 'Harga bervariasi';
            }
        }

        // Fungsi untuk menghasilkan rekomendasi personal
        function generatePersonalRecommendations() {
            document.getElementById('personalRecommendationsGrid').innerHTML = 
                '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Menghasilkan rekomendasi personal...</div>';

            setTimeout(() => {
                // Algoritma rekomendasi personal berdasarkan rating dan popularitas
                const personalRecommendations = allProducts
                    .filter(product => product.rating >= 4.5 || product.is_new)
                    .sort((a, b) => b.rating - a.rating)
                    .slice(0, 6);

                displayPersonalRecommendations(personalRecommendations);
            }, 1500);
        }

        function displayPersonalRecommendations(recommendations) {
            const grid = document.getElementById('personalRecommendationsGrid');
            
            if (recommendations.length === 0) {
                grid.innerHTML = '<div class="error">Tidak ada rekomendasi personal saat ini.</div>';
                return;
            }

            let html = '';
            
            recommendations.forEach(product => {
                const stars = renderStars(product.rating);
                
                html += `
                    <div class="recommendation-card" onclick="showProductDetail(${JSON.stringify(product).replace(/"/g, '&quot;')})">
                        <div class="recommendation-header">
                            <div class="product-name">${product.name}</div>
                            <div class="similarity-badge">TERSEDIA</div>
                        </div>
                        <div class="product-brand">${product.brand}</div>
                        <div class="product-category">${product.category}</div>
                        <div class="product-rating">
                            ${stars}
                            <span style="margin-left: 5px; color: var(--text-light);">${product.rating}</span>
                        </div>
                        <div class="product-price">${formatPrice(product.price_range)}</div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: var(--text-light);">
                            <div><i class="fas fa-user-circle"></i> ${product.skin_type}</div>
                        </div>
                    </div>
                `;
            });

            grid.innerHTML = html;
        }

        function getProductRecommendations(productId) {
            document.getElementById('recommendationsGrid').innerHTML = 
                '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Mencari rekomendasi...</div>';

            // Simulasi delay untuk efek loading
            setTimeout(() => {
                const selectedProduct = allProducts.find(p => p.product_id === productId);
                const recommendations = getSimilarProducts(selectedProduct);
                displayRecommendations(recommendations, `Berdasarkan ${selectedProduct.name}:`);
            }, 1000);
        }

        function getSimilarProducts(product) {
            // Algoritma sederhana untuk mencari produk serupa
            return allProducts
                .filter(p => 
                    p.product_id !== product.product_id && 
                    (p.category === product.category || p.brand === product.brand || p.skin_type === product.skin_type)
                )
                .sort((a, b) => {
                    let scoreA = 0;
                    let scoreB = 0;
                    
                    if (a.category === product.category) scoreA += 3;
                    if (a.brand === product.brand) scoreA += 2;
                    if (a.skin_type === product.skin_type) scoreA += 1;
                    
                    if (b.category === product.category) scoreB += 3;
                    if (b.brand === product.brand) scoreB += 2;
                    if (b.skin_type === product.skin_type) scoreB += 1;
                    
                    return scoreB - scoreA;
                })
                .slice(0, 6);
        }

        function getPreferenceRecommendations() {
            const preferences = {
                skin_type: document.getElementById('skinType').value,
                category: document.getElementById('category').value,
                brand: document.getElementById('brand').value,
                price_range: document.getElementById('priceRange').value
            };

            document.getElementById('recommendationsGrid').innerHTML = 
                '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Mencari rekomendasi berdasarkan preferensi Anda...</div>';

            // Simulasi delay untuk efek loading
            setTimeout(() => {
                let filteredProducts = allProducts;

                if (preferences.skin_type !== 'all') {
                    filteredProducts = filteredProducts.filter(p => p.skin_type === preferences.skin_type);
                }
                if (preferences.category) {
                    filteredProducts = filteredProducts.filter(p => p.category === preferences.category);
                }
                if (preferences.brand) {
                    filteredProducts = filteredProducts.filter(p => p.brand === preferences.brand);
                }
                if (preferences.price_range) {
                    filteredProducts = filteredProducts.filter(p => p.price_range === preferences.price_range);
                }

                const minRating = parseFloat(document.querySelector('#ratingFilter .filter-btn.active').getAttribute('data-rating'));
                if (minRating > 0) {
                    filteredProducts = filteredProducts.filter(p => p.rating >= minRating);
                }

                displayRecommendations(filteredProducts.slice(0, 6), 'Berdasarkan preferensi Anda:');
            }, 1000);
        }

        function displayRecommendations(recommendations, title) {
            const grid = document.getElementById('recommendationsGrid');
            
            if (recommendations.length === 0) {
                grid.innerHTML = '<div class="error">Tidak ditemukan rekomendasi yang sesuai.</div>';
                return;
            }

            let html = `<div class="recommendation-title">${title}</div>`;
            
            recommendations.forEach(product => {
                const stars = renderStars(product.rating);
                
                html += `
                    <div class="recommendation-card" onclick="showProductDetail(${JSON.stringify(product).replace(/"/g, '&quot;')})">
                        <div class="recommendation-header">
                            <div class="product-name">${product.name}</div>
                            <div class="similarity-badge">${Math.floor(Math.random() * 20) + 80}% Match</div>
                        </div>
                        <div class="product-brand">${product.brand}</div>
                        <div class="product-category">${product.category}</div>
                        <div class="product-rating">
                            ${stars}
                            <span style="margin-left: 5px; color: var(--text-light);">${product.rating}</span>
                        </div>
                        <div class="product-price">${formatPrice(product.price_range)}</div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: var(--text-light);">
                            <div><i class="fas fa-user-circle"></i> ${product.skin_type}</div>
                        </div>
                    </div>
                `;
            });

            grid.innerHTML = html;
        }

        // Fungsi untuk menampilkan semua rekomendasi
        function showAllRecommendations() {
            const modal = document.getElementById('allRecommendationsModal');
            const content = document.getElementById('allRecommendationsGrid');
            
            // Generate semua rekomendasi terbaik
            const allRecommendations = allProducts
                .filter(product => product.rating >= 4.3)
                .sort((a, b) => b.rating - a.rating);
            
            let html = '';
            
            allRecommendations.forEach(product => {
                const stars = renderStars(product.rating);
                
                html += `
                    <div class="recommendation-card" onclick="showProductDetail(${JSON.stringify(product).replace(/"/g, '&quot;')})">
                        <div class="recommendation-header">
                            <div class="product-name">${product.name}</div>
                            <div class="similarity-badge">${Math.floor(Math.random() * 15) + 85}% Match</div>
                        </div>
                        <div class="product-brand">${product.brand}</div>
                        <div class="product-category">${product.category}</div>
                        <div class="product-rating">
                            ${stars}
                            <span style="margin-left: 5px; color: var(--text-light);">${product.rating}</span>
                        </div>
                        <div class="product-price">${formatPrice(product.price_range)}</div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: var(--text-light);">
                            <div><i class="fas fa-user-circle"></i> ${product.skin_type}</div>
                        </div>
                    </div>
                `;
            });

            content.innerHTML = html;
            modal.style.display = 'flex';
        }

        function closeAllRecommendationsModal() {
            document.getElementById('allRecommendationsModal').style.display = 'none';
        }

        function searchProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (searchTerm === '') {
                displayProducts(allProducts);
                return;
            }
            
            const filteredProducts = allProducts.filter(product => 
                product.name.toLowerCase().includes(searchTerm) || 
                product.brand.toLowerCase().includes(searchTerm) ||
                product.category.toLowerCase().includes(searchTerm)
            );
            
            displayProducts(filteredProducts);
        }

        function filterProducts(category) {
            document.querySelectorAll('.filter-options .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            if (category === 'all') {
                displayProducts(allProducts);
                return;
            }
            
            const filteredProducts = allProducts.filter(product => 
                product.category.toLowerCase() === category.toLowerCase()
            );
            
            displayProducts(filteredProducts);
        }

        function filterByRating(minRating) {
            if (minRating === 0) {
                displayProducts(allProducts);
                return;
            }
            
            const filteredProducts = allProducts.filter(product => 
                product.rating >= minRating
            );
            
            displayProducts(filteredProducts);
        }

        function showProductDetail(product) {
            const modal = document.getElementById('productModal');
            const modalContent = document.getElementById('modalContent');
            
            const stars = renderStars(product.rating);
            
            modalContent.innerHTML = `
                <div class="product-detail">
                    <div class="product-image">
                        <i class="fas fa-palette"></i>
                    </div>
                    <div class="product-info">
                        <h3>${product.name}</h3>
                        <p><strong>Brand:</strong> ${product.brand}</p>
                        <p><strong>Kategori:</strong> ${product.category}</p>
                        <p><strong>Jenis Kulit:</strong> ${product.skin_type}</p>
                        <p><strong>Rentang Harga:</strong> ${formatPrice(product.price_range)}</p>
                        <p><strong>Deskripsi:</strong> ${product.description}</p>
                        
                        <div class="star-rating">
                            ${stars}
                            <span style="margin-left: 10px; color: var(--text-light);">${product.rating}/5</span>
                        </div>
                        
                        <div class="price-tag">${formatPrice(product.price_range)}</div>
                        
                        <div class="action-buttons">
                            <button class="action-btn primary-btn" onclick="getProductRecommendations(${product.product_id}); closeModal();">
                                <i class="fas fa-heart"></i> Lihat Rekomendasi Serupa
                            </button>
                            <button class="action-btn secondary-btn" onclick="closeModal()">
                                <i class="fas fa-times"></i> Tutup
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('productModal').style.display = 'none';
        }

        function addToHistory(product) {
            viewHistory = viewHistory.filter(item => item.product_id !== product.product_id);
            viewHistory.unshift(product);
            
            if (viewHistory.length > 5) {
                viewHistory = viewHistory.slice(0, 5);
            }
            
            localStorage.setItem('beautyFinderHistory', JSON.stringify(viewHistory));
            loadHistory();
        }

        function loadHistory() {
            const historyContainer = document.getElementById('historyItems');
            
            if (viewHistory.length === 0) {
                historyContainer.innerHTML = '<div style="color: var(--text-light); font-style: italic;">Belum ada riwayat</div>';
                return;
            }
            
            historyContainer.innerHTML = '';
            
            viewHistory.forEach(product => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.textContent = product.name;
                historyItem.onclick = () => {
                    getProductRecommendations(product.product_id);
                    showProductDetail(product);
                };
                
                historyContainer.appendChild(historyItem);
            });
        }

        function clearHistory() {
            viewHistory = [];
            localStorage.setItem('beautyFinderHistory', JSON.stringify(viewHistory));
            loadHistory();
        }
    </script>
</body>
</html>

